# 공유 자전거 플랫폼(따릉이)

### 서비스 시나리오

#### 기능적 요구사항

    1. 고객이 이용권을 선택하여 구매한다 (일일권 - 60분 1000원, 120분 2000원)
    2. 고객이 결제한다
    3. 고객은 구매한 이용권을 사용하여 대여가능 상태의 자전거를 대여한다
    4. 자전거 대여시 고객에게 대여 안내 알림을 전송한다
    5. 자전거를 대여한 고객은 자전거 반납이 가능하다
    6. 자전거 반납시 고객에게 반납 안내 알림을 전송한다
    7. 자전거 반납후 기본 대여시간 초과 하여 추가요금 발생시 결제 알림을 전송한다
    8. 관리자는 자전거를 등록, 삭제할 수 있다.

*****

#### 비기능적 요구사항
    
    1. 트랜잭션 - 결제 완료된 이후에 고객은 이용권 사용이 가능하다
    2. 장애격리 - 자전거 대여 / 반납 은 24시간 받을수 있어야 한다
               - 결제시스템이 과중되면.. 결제를 잠시후에 하도록.. 
    3. 성능 - 고객이 자주 남은 대여시간을 확인 가능해야 한다
            - 자전거 대여 상태 변경시 고객에게 알림을 줄 수 있어야 한다 
*****

![image](https://user-images.githubusercontent.com/61194075/122356178-81cd8400-cf8d-11eb-9bc2-3d40f7bcea82.png)

#### [수정사항 1] 자전거 대여 시 이용권 차감(ticket → updateTicket)
![image](https://user-images.githubusercontent.com/61194075/122364665-eb04c580-cf94-11eb-991e-10a08f2a36cf.png)

#### [ISSUE 1] 이용권은 다건을 만들어서 관리하려 했으나 ticket Aggregate에서 수량관리를 할 수 없는 구조
![image](https://user-images.githubusercontent.com/61194075/122494190-de7b7e00-d023-11eb-98d3-9f634f43bb81.png)

#### [수정사항 2] 1개의 이용권을 구매해서 대여까지 할 수 있도록 구조변경
#### - 이용권의 상태만 변경하면 되므로 confirmTicket, confirmCancelTicket은 updateTicket과 동일한 기능이므로 병합
![image](https://user-images.githubusercontent.com/61194075/122495371-dcfe8580-d024-11eb-863e-77f6b84333f6.png)

### 분석/설계

*****

### 구현

*****



